%This file will contain our design approach
%Describe the basis and then the architecture here - for example how do you calculate medians, what kind of parallelism model is employed? How often do you need to synchronize? etc.
\subsection{Query 1}
For query 1, we have one house process for each house in the data set and a broker process. The broker process reads the data from the input stream and passes it to the corresponding house process. Communication between the processes is done via operating system sockets. House process gets a measurement from the broker and produces a forecast for the next to next time slice. 
For each slice size, we need to forecast the load for next to next time slice 
\subsection{Query 2}
For query 2, a single multithreaded process reads the data and outputs the outliers. 
\subsection{The Median Algorithm}
[Why do we need a median container?
What operations do we need from the median container?
why approximate?]

In query 2, we need the median of total load of all the plugs in all the houses and the median of load of each plug for the last one hour window and for the last 24 hour window. These windows are sliding. So, to calculate the median, we need to store the values in a container. This container must support operations to insert a value, delete a value and find the median efficiently. If we want exact median then we need to store all the values in an array, in which case, finding the median will be a constant order operation. But inserting or deleting a value will take linear time. To avoid this, we can use a container which gives approximate median.


[explain the algorithm]
In this experiment, we have used a container which is implemented as follows:

We have N bins. We store the starting value of each bin as well as the number of values in that bin (frequency of the bin). We also store the pointer to the bin containing the median and cumulative sum of the frequencies upto and including that bin. Now the three operations (insert a value, delete a value and get the median) are implemented as follows:



\begin{itemize}
  \item Get the median
  
  get the median
  
  \item Insert a value
  
  When we stream in the input data, we record the first N values. If the stream is smaller than the numberof bins(N), then we can get the exact median. Else, we use insert and delete functions as follows
 
  \item Delete a value
  
  Delete a value
  
\end{itemize}







Final complexity

Maybe graphs

%We have implemented an approximate median algorithm. We divide the incoming data into n bins. Each bin has a frequency 